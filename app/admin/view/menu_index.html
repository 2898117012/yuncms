<!-- 右侧内容 -->
<div id="main" class="col-xs-12 col-sm-9 main" style="overflow-y: scroll;">
    <!-- 面包屑导航 -->
    <ul class="breadcrumb">
        <li><i class="fa fa-map-marker"></i></li>
        {foreach $positionlink as $vo}
        <li class="text-muted">{$vo.title}</li>
        {/foreach}
    </ul>

    <!-- 主体内容区域 -->
    <div class="tab-content ct-tab-content">

        <div class="panel-body">
            <div class="builder listbuilder-box">
                <!-- Tab导航 -->
                <!-- 顶部工具栏按钮 -->
                <div class="builder-toolbar">
                    <div class="row">
                        <!-- 工具栏按钮 -->
                        <div class="col-xs-12 col-sm-8 button-list clearfix">
                            <div class="form-group">
                                <a title="新增" class="btn btn-primary-outline btn-pill" href="{:U('admin/menu/add')}">新增</a>&nbsp;<a title="显示" target-form="ids" class="btn btn-success-outline btn-pill ajax-yuncms confirm" href="javascript:void(0);" url="{:U('admin/menu/changehide','id=select&hide=0')}">显示</a>&nbsp;
                                <a title="隐藏" target-form="ids" class="btn btn-warning-outline btn-pill  confirm" href="{:U('admin/menu/changehide','id=select&hide=1')}">隐藏</a>&nbsp;
                                <a title="删除" target-form="ids" class="btn btn-danger-outline btn-pill confirm" href="{:U('admin/menu/delete','id=select&type=0')}">删除</a>&nbsp; </div>
                        </div>
                        <!-- 搜索框 -->
                        <div class="col-xs-12 col-sm-4 clearfix">
                            <form class="form" method="get" action="{:U('admin/menu/index')}">
                                <div class="form-group">
                                    <div class="input-group search-form">
                                        <input type="text" name="keyword" class="search-input form-control" value="" placeholder="请输入查询菜单的关键字">
                                        <span class="input-group-btn"><a class="btn btn-default search-btn"><i class="fa fa-search"></i></a></span>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- 数据列表 -->
                <div class="builder-container">
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="builder-table">
                                <div class="panel panel-default table-responsive">
                                    <table class="table table-bordered table-striped table-hover">
                                        <thead>
                                            <tr>
                                                <th><input class="check-all" type="checkbox"></th>
                                                <th>排序</th>
                                                <!-- <th>ID</th> -->
                                                <th>菜单名称</th>
                                                <!-- <th>URL</th> -->
                                                <th>图标</th>
                                                <th>状态(<i class="fa fa-check text-success"></i>显示 <i class="fa fa-ban text-danger"></i>隐藏)</th>
                                                <th>操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>

                                            {foreach $menulist as $vo}
                                            <tr>
                                                <td>
                                                    <input class="ids" type="checkbox" value="{$vo.id}" name="ids[]">
                                                </td>
                                                <td>
                                                    <div class="layui-input-inline">
                                                        <input type="text" name="sort" value="{$vo.sort}" lay-verify="sort" autocomplete="off" class="layui-input" style="max-width:30px;text-align:center;" />
                                                    </div>
                                                </td>
                                                <!-- <td> {$vo.id} </td> -->
                                                <td> {$vo._title} </td>
                                                <!-- <td> {$vo.url} </td> -->
                                                <td><i class="{$vo.icon} "></i></td>
                                                <td>
                                                    {if condition="$vo.hide eq 0"}
                                                    <a href="javascript:void(0);" url="{:U('admin/menu/changehide','id='.$vo['id'].'&hide=1')}" class="ajax-yuncms"><i class="fa fa-check text-success"></i> {else /}
                                                    <a href="javascript:void(0);" url="{:U('admin/menu/changehide','id='.$vo['id'].'&hide=0')}" class="ajax-yuncms">
                                                    <i class="fa fa-ban text-danger"></i> {/if}
                                                  </a>
                                                </td>
                                                <td>
                                                    <!-- <a class="label label-warning" href="#">超级管理员无需操作</a> -->
                                                    <a name="edit" title="编辑" class="label label-primary-outline label-pill" href="{:U('admin/menu/edit','id='.$vo['id'].'')}">编辑</a>
                                                    <a name="delete" title="删除" class="label label-danger-outline label-pill ajax-get confirm" model="Group" href=":U('admin/menu/delete','id='.$vo['id'].'')}">删除</a>
                                                </td>
                                            </tr>
                                            {/foreach}
                                        </tbody>
                                    </table>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

                <!-- 额外功能代码 -->
            </div>

        </div>

    </div>


    <script type="text/javascript">
        $(document).on('click', '.ajax-yuncms', function() {
            var chk_ids = jqchk();
            //alert(chk_ids);
            var urls = $(this).attr('url');
            var backurl = $('#curr_url').val();
            //alert(backurl);
            $.ajax({
                type: "GET",
                url: urls,
                dataType: "json",
                data: "ids=" + chk_ids,
                success: function(data) {
                    console.log(data);
                    if (data.status == 1) {
                        //alert(backurl);
                        window.location.href = 'http://' + document.domain + backurl;
                        $.alertMessager(data.info, 'success');
                    } else {
                        $.alertMessager(data.info, 'danger');
                    }
                }
            });

        });

        //jquery获取复选框值
        function jqchk() {
            var chk_value = [];
            $('input[name="ids[]"]:checked').each(function() {
                chk_value.push($(this).val());
            });
            if (chk_value.length > 0) {
                return chk_value;
            } else {
                return '';
            }
        }
    </script>
